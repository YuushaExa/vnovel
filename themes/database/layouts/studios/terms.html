{{ define "main" }}
  <h1>{{ .Title }}</h1>
  {{ .Content }}
  
  {{/* First collect all sections with their page counts */}}
  {{ $sections := slice }}
  {{ range .Paginator.Pages }}
    {{ $pageCount := len .Pages }}
    {{ $section := dict "Page" . "Count" $pageCount }}
    {{ $sections = $sections | append $section }}
  {{ end }}
  
  {{/* Sort sections by page count (descending) */}}
  {{ $sortedSections := sort $sections "Count" "desc" }}
  
  {{/* Now range through the sorted sections */}}
  {{ range $sortedSections }}
    <div class="card">
      {{ $firstPage := index .Page.Pages 0 }}
      {{ if and $firstPage $firstPage.Params.image }}
        <div class="card-image">
          <img src="{{ $firstPage.Params.image }}" alt="{{ $firstPage.LinkTitle }}">
        </div>
      {{ end }}
      <div class="card-content">
        <h2><a href="{{ .Page.RelPermalink }}">{{ .Page.LinkTitle }}</a></h2>
        <p>{{ .Count }} post{{ if ne .Count 1 }}s{{ end }}</p>
      </div>
    </div>
  {{ end }}
  
  <div class="column is-narrow">
    {{ partial "widgets/pagination.html" . }}
  </div>
{{ end }}
